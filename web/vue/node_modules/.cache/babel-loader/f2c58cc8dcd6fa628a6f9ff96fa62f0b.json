{"remainingRequest":"/home/stillfantasy/Desktop/gekko/web/vue/node_modules/thread-loader/dist/cjs.js!/home/stillfantasy/Desktop/gekko/web/vue/node_modules/babel-loader/lib/index.js!/home/stillfantasy/Desktop/gekko/web/state/reduceState.js","dependencies":[{"path":"/home/stillfantasy/Desktop/gekko/web/state/reduceState.js","mtime":1536648477493},{"path":"/home/stillfantasy/Desktop/gekko/web/vue/node_modules/cache-loader/dist/cjs.js","mtime":1542011033634},{"path":"/home/stillfantasy/Desktop/gekko/web/vue/node_modules/thread-loader/dist/cjs.js","mtime":1542011034414},{"path":"/home/stillfantasy/Desktop/gekko/web/vue/node_modules/babel-loader/lib/index.js","mtime":1529635966000}],"contextDependencies":[],"result":["// Redux/vuex inspired reducer, reduces an event into a gekko state.\n// NOTE: this is used by the backend as well as the frontend.\n\nconst skipInitialEvents = ['marketUpdate'];\nconst skipLatestEvents = ['marketStart', 'stratWarmupCompleted'];\nconst trackAllEvents = ['tradeCompleted', 'advice', 'roundtrip'];\n\nconst reduce = (state, event) => {\n  const type = event.type;\n  const payload = event.payload;\n\n  state = {\n    ...state,\n    latestUpdate: new Date()\n  }\n\n  if(trackAllEvents.includes(type)) {\n    if(!state.events[type]) {\n      state = {\n        ...state,\n        events: {\n          ...state.events,\n          [type]: [ payload ]\n        }\n      }\n    } else {\n      state = {\n        ...state,\n        events: {\n          ...state.events,\n          [type]: [ ...state.events[type], payload ]\n        }\n      }\n    }\n  }\n\n  if(!state.events.initial[type] && !skipInitialEvents.includes(type)) {\n    state = {\n      ...state,\n      events: {\n        ...state.events,\n        initial: {\n          ...state.events.initial,\n          [type]: payload\n        }\n      }\n    }\n  }\n\n  if(!skipLatestEvents.includes(type)) {\n    state = {\n      ...state,\n      events: {\n        ...state.events,\n        latest: {\n          ...state.events.latest,\n          [type]: payload\n        }\n      }\n    }\n  }\n\n  return state;\n}\n\n// export default reduce;\nmodule.exports = reduce;",null]}